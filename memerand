import telebot
from –¢–µ–ª–µ–≥—Ä–∞–º–º.config import *
import os
import random

bot = telebot.TeleBot(api_token)
bot.send_message(CHAT_ID, "ü§ñ –ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!")

# –°–ª–æ–≤–∞—Ä—å —Å –≤–µ—Å–∞–º–∏ –¥–ª—è –º–µ–º–æ–≤ (–Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: –≤–µ—Å)
# –ß–µ–º –±–æ–ª—å—à–µ –≤–µ—Å, —Ç–µ–º —á–∞—â–µ –º–µ–º –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è
memes_weights = {
    "mem1.jpg": 10,  # –ß–∞—Å—Ç—ã–π –º–µ–º
    "mem2.jpg": 8,  # –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç—ã–π
    "mem3.jpg": 3,  # –†–µ–¥–∫–∏–π –º–µ–º

}
rarest_mem = min(memes_weights, key=memes_weights.get)

@bot.message_handler(commands=['mem'])
def send_mem(message):
    # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    memes_files = os.listdir('../images')

    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å —É—á–µ—Ç–æ–º –≤–µ—Å–æ–≤
    weighted_memes = []
    for mem in memes_files:
        weight = memes_weights.get(mem, 5)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–µ—Å 5, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
        weighted_memes.extend([mem] * weight)

    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –º–µ–º —Å —É—á–µ—Ç–æ–º –≤–µ—Å–æ–≤
    chosen_mem = random.choice(weighted_memes)
    mem_path = f"../images/{chosen_mem}"

    print(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω –º–µ–º: {chosen_mem} (–≤–µ—Å: {memes_weights.get(chosen_mem, 5)})")

    try:
        with open(mem_path, 'rb') as f:
            bot.send_photo(message.chat.id, f)

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–µ–º —Å–∞–º—ã–º —Ä–µ–¥–∫–∏–º
            if chosen_mem == rarest_mem:
                bot.send_message(message.chat.id, "üéâ –í—ã –≤—ã–±–∏–ª–∏ —Å–∞–º—ã–π —Ä–µ–¥–∫–∏–π –º–µ–º! üéâ")

    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–µ–º–∞: {e}")


bot.polling()
